/*! Copyright (c) Epic Systems Corporation 2016 */
(function WP$Utilities$UI$SidebarManager$definition(){var a=null,e={},j=function WP$Utilities$UI$SidebarManager$addWidget(b,a,e,d){return new c(b,a,e,!d)},c=function WP$Utilities$UI$SidebarManager$SidebarWidget(g,c,e,h){var a=this;a.id=i++;a._template=g;a._priority=e;a._shown=h;a._addToStaticStructures();a._$container=$$WP.SimpleTemplates.Div({"class":"jqHidden"});f=f||$afe.select("#sidebar");if(d===1)f.safeAppend(a._$container);else if(a===b)a._$container.safeInsertBefore(a._next._$container);else a._$container.safeInsertAfter(a._previous._$container);a.update(c);a._shown&&a._$container.show()},g={ViewModel:a,_template:a,_priority:a,_$container:a,_previous:a,_next:a,_shown:true,update:function WP$Utilities$UI$SidebarManager$s_SidebarWidget$update(b){var a=this;a._$container.empty();a._$container.safeAppend($afe.renderTemplate(a._template,b));a.ViewModel=b},show:function WP$Utilities$UI$SidebarManager$s_SidebarWidget$show(){if(!this._shown){this._$container.show();this._shown=true}},hide:function WP$Utilities$UI$SidebarManager$s_SidebarWidget$hide(){if(this._shown){this._$container.hide();this._shown=false}},remove:function WP$Utilities$UI$SidebarManager$s_SidebarWidget$remove(){var c=this;c._$container.remove();if(c===b)b=c._next;else{c._previous._next=c._next;if(c._next!==a)c._next._previous=c._previous}d--},_addToStaticStructures:function WP$Utilities$UI$SidebarManager$_addToStaticStructures(){var c=this,e,f;if(b===a)b=c;else if(c._priority<b._priority){c._next=b;b._previous=c;b=c}else{f=b;e=b;while(e!==a&&c._priority>=e._priority){f=e;e=e._next}c._next=f._next;c._previous=f;f._next=c;if(c._next!==a)c._next._previous=c}d++}},h=function WP$Utilities$UI$SidebarManager$numberOfWidgets(){return d},f=a,i=0,b=a,l={},k={},d=0;c.prototype=g;e.addWidget=j;e.numberOfWidgets=h;c.extend($$WP.BaseObject,"WP$Utilities$UI$SidebarWidget");$$WP.Utilities.UI.SidebarWidget=c;$$WP.Utilities.UI.SidebarManager=e})();$$WP.Debug.UnitTest=$$WP.Debug.UnitTest||{};$$WP.Debug.UnitTest.tests=$$WP.Debug.UnitTest.tests||[];$$WP.Debug.UnitTest.tests.push(function UnitTests$Utilities$UI$SidebarManager(){var B='div[data-name="Widget4"]',r="remove() did not cause the number of elements directly contained by the sidebar to decrease by 1",w='div[data-name="Widget3"]',v='div[data-name="Widget2"]',q=":visible",A="The rendered version of Widget1 did not contain the expected value in the data-content attribute",m="data-content",p="addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1",n='div[data-name="Widget1"]',d,a,e,h,g,b,o,j,x,y,z,c,i,f,k,l,s,t,u;d=$$WP.Debug.UnitTest.assert;a=$$WP.Debug.UnitTest.assertValue;e=$$WP.Utilities.UI.SidebarManager;SidebarWidget=$$WP.Utilities.UI.SidebarWidget;o=function(a){return'<div style="border: 1px solid black;" data-name="'+a.name+'" data-content="'+a.content+'"> Widget '+a.name+" priority: "+a.priority+" content: "+a.content+"</div>"};l={name:"Widget1",priority:10,content:"A"};s={name:"Widget2",priority:5,content:"C"};t={name:"Widget3",priority:5,content:"D"};u={name:"Widget4",priority:-1,content:"E"};b=$afe.select("#sidebar");g=b.children().size();h=e.numberOfWidgets();j=e.addWidget(o,l,l.priority);c=b.find(n);d(SidebarWidget.isInstance(j),"addWidget() did not return a valid SidebarWidget instance for Widget1");a(h+1,e.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget1");a(g+1,b.children().size(),p);a(1,c.size(),"Did not find the rendered version of Widget1 in the sidebar after adding it using addWidget()");a("A",c.safeAttr(m),A);d(c.is(q),"Widget1 was not rendered shown by default");j.hide();d(!c.is(q),"Widget1 was not hidden by the call to hide()");j.show();d(c.is(q),"Widget1 was not shown by the call to show()");j.hide();l.content="B";j.update(l);c=b.find(n);a(h+1,e.numberOfWidgets(),"update() changed the widget count");a(g+1,b.children().size(),"update() changed the number of child elements of the sidebar");a(1,c.size(),"Unable to find Widget1 in the sidebar after calling update() ");a(l.content,c.safeAttr(m),A);d(!c.is(q),"update() made Widget1 visible when it should not have");j.show();x=e.addWidget(o,s,s.priority);c=b.find(n);i=b.find(v);d(SidebarWidget.isInstance(x),"addWidget() did not return a valid SidebarWidget instance for Widget2");a(h+2,e.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget2");a(g+2,b.children().size(),p);a(1,i.size(),"Did not find the rendered version of Widget2 in the sidebar after adding it using addWidget()");a(s.content,i.safeAttr(m),"The rendered version of Widget2 did not contain the expected value in the data-content attribute");a(1,c.size(),"Did not find the rendered version of Widget1 in the sidebar after adding Widget2 using addWidget()");a(l.content,c.safeAttr(m),"The rendered version of Widget1 did not contain the expected value in the data-content attribute after calling addWidget() to add Widget2");d(i.parent().next().get(0)===c.parent().get(0),"Widget2 was not inserted directly before Widget1 in the DOM");y=e.addWidget(o,t,t.priority);c=b.find(n);i=b.find(v);f=b.find(w);d(SidebarWidget.isInstance(y),"addWidget() did not return a valid SidebarWidget instance for Widget3");a(h+3,e.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget3");a(g+3,b.children().size(),p);a(1,f.size(),"Did not find the rendered version of Widget3 in the sidebar after adding it using addWidget()");a(t.content,f.safeAttr(m),"The rendered version of Widget3 did not contain the expected value in the data-content attribute");d(f.parent().next().get(0)===c.parent().get(0),"Widget3 was not inserted directly before Widget1 in the DOM");d(i.parent().next().get(0)===f.parent().get(0),"Widget3 was not inserted directly after Widget2 in the DOM");j.remove();c=b.find(n);a(h+2,e.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget1");a(g+2,b.children().size(),r);a(0,c.size(),"Widget1 was still found in the sidebar after calling remove()");d(f.parent().next().size()===0,"Widget3 still had something after it in the sidebar");d(i.parent().next().get(0)===f.parent().get(0),"Widget3 is not directly after Widget2 in the DOM");x.remove();i=b.find(v);a(h+1,e.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget2");a(g+1,b.children().size(),r);a(0,i.size(),"Widget2 was still found in the sidebar after calling remove()");d(f.parent().next().size()===0,"Widget3 was not the last element in the sidebar though it is the last remaining widget");z=e.addWidget(o,u,u.priority);f=b.find(w);k=b.find(B);d(SidebarWidget.isInstance(z),"addWidget() did not return a valid SidebarWidget instance for Widget4");a(h+2,e.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget4");a(g+2,b.children().size(),p);a(1,k.size(),"Did not find the rendered version of Widget4 in the sidebar after adding it using addWidget()");a(u.content,k.safeAttr(m),"The rendered version of Widget4 did not contain the expected value in the data-content attribute");d(k.parent().next().get(0)===f.parent().get(0),"Widget4 was not inserted directly before Widget3 in the DOM");y.remove();f=b.find(w);a(h+1,e.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget3");a(g+1,b.children().size(),r);a(0,f.size(),"Widget3 was still found in the sidebar after calling remove()");d(k.parent().next().size()===0,"Widget4 was not the last element in the sidebar though it is the last remaining widget");z.remove();k=b.find(B);a(h,e.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget4");a(g,b.children().size(),r);a(0,k.size(),"Widget4 was still found in the sidebar after calling remove()")})