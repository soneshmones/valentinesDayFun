/*! Copyright (c) Epic Systems Corporation 2014-2016 */
$$WPComp.TimeoutWarningComponent=function WPComp$TimeoutWarningComponent(e){var h="inlinedelete",d="stay",b=null,g="@MYCHART@SecondsLeft@",a=this,f,c;$$WP.Strings.setDefaultNamespace("Core.TimeOutPopup");f=$$WP.HyperspaceSession?"FromHyperspace":WP.Events.showBeforeUnloadMessage()?"WithChanges":"TimeOut";a.PreHtml=e.Html||e.Text||$$WP.Strings.get(f+"Message");a.Html=a.PreHtml;$$WPComp.applySettings(e,a);a._SecondsAtStart=Math.floor(a.SecondsLeft)||60;$$WP.Strings.addMnemonic(g,a._SecondsAtStart.toString());if($$WP.HyperspaceSession)c=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("FromHyperspaceStayButtonText"),b,"",d)];else if(a.isPreLogin)c=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("PreLoginStayButtonText"),b,"",d),new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("PreLoginLogOutButtonText"),b,h,"leave")];else c=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("StayButtonText"),b,"",d),new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("LogOutButtonText"),b,h,"leave")];a._clickContext=a._clickContext||a;a.TitleText=a.TitleText||$$WP.Strings.getForTemplate(f+"Title");a.ToolbarButtons=c;a.Components$Component({});$$WP.Strings.removeMnemonic(g);$$WP.Strings.clearDefaultNamespace();$.proxy(a._createScreenReaderAlert(),a);a._timer=$.proxy(a._timer,a);a._TimerId=window.setTimeout(a._timer,1e3);a.$content.safeAttr("aria-hidden",true);a._D0=new Date;a.addEventListener("click",a.clickTimeoutWarning);$$WPComp.TimeoutWarningComponent.hasVisibleInstance=true};$$WPComp.TimeoutWarningComponent.prototype={ToolbarButtons:null,SecondsLeft:60,_SecondsAtStart:Number,_D0:new Date,_TimerId:Number,_isFirstTime:true,IsClosable:true,isPreLogin:false,Class:"timeoutwarning",clickTimeoutWarning:function WPComp$TimeoutWarningComponent$_click(a){if(!a.dataId)return;a.dataId===$$WPComp.TOOLBARIDENTIFIER+"leave"&&$$WPComp.TimeoutWarningComponent.leaveClick(this.isPreLogin);this.dispose(true);return false},_timer:function WPComp$TimeoutWarningComponent$_timer(){var c="@MYCHART@SecondsLeft@",e="#screenReaderAlertTimeout",a=this,f,b;$afe.select(".Popup").removeAttr("aria-live");var d=$afe.select(e);d.innerHTML=a.PreHtml;f=new Date;b=Math.floor(a._SecondsAtStart-Math.round((f-a._D0)/1e3,0));if(b<=0){$$WPComp.TimeoutWarningComponent.leaveClick(a.isPreLogin);a.dispose(true)}else{$$WP.Strings.clearDefaultNamespace();$$WP.Strings.setDefaultNamespace("Core.TimeOutPopup");a._timerId=window.setTimeout(a._timer,1e3);if(b%10==0||a._isFirstTime){a._isFirstTime=false;var d=$afe.select(e);d.innerHTML=a.PreHtml;$$WP.Strings.addMnemonic(c,b.toString());$$WP.Strings.setDisplayText(d,"Message");$$WP.Strings.removeMnemonic(c)}$$WP.Strings.addMnemonic(c,b.toString());a.html(a.PreHtml);$$WP.Strings.removeMnemonic(c);$$WP.Strings.clearDefaultNamespace()}},dispose:function WPComp$TimeoutWarningComponent$dispose(b){var a=this;if(a._isDisposed)return;window.clearTimeout(a._timerId);a._timerId=null;a.Components$Component$dispose(b);$$WPUtil.setActivity();checkActivity();$$WP.Strings.getNamespace("Core.TimeOutPopup").removeMnemonic("@MYCHART@SecondsLeft@");$$WPComp.TimeoutWarningComponent.hasVisibleInstance=false},_createScreenReaderAlert:function WPComp$TimeoutWarningComponent$createScreenReaderAlert(){var d="@MYCHART@SecondsLeft@",b=this;$$WP.Strings.clearDefaultNamespace();$$WP.Strings.setDefaultNamespace("Core.TimeOutPopup");var c=b.$content,a=c.clone();a.addClass("clearlabel");a.safeAttr("id","screenReaderAlertTimeout");b.$container.safeAppend(a);c=$afe.select("#screenReaderAlertTimeout");c.innerHTML=b.PreHtml;$$WP.Strings.addMnemonic(d,b._SecondsAtStart.toString());$$WP.Strings.setDisplayText(c,"TimeOutMessage");$$WP.Strings.removeMnemonic(d);a.safeAttr("aria-hidden",false);a.safeAttr("aria-live","assertive");a.safeAttr("aria-relevant","additions");a.safeAttr("aria-atomic",true);$$WP.Strings.clearDefaultNamespace()}};$$WPComp.TimeoutWarningComponent.leaveClick=function WPComp$TimeoutWarningComponent$leaveClick(c){WP.Events.cancelBeforeUnload();var a,b;if(c){if(window.location!==window.parent.location)document.location.href=document.location.href;else window.location.reload(false);return}a=new $$WPComp.LoggingOutComponent;b=new $$WPContain.Popup({positioningFunction:$$WPContain.Positions.InsideCentered,Components:a,Class:"logout"});b.show(true)};$$WPComp.TimeoutWarningComponent.extend("Components.Component")