/*! Copyright (c) Epic Systems Corporation 2011 - 2019 */
if(typeof WP==="undefined")WP={};if(typeof WP.Comm==="undefined")WP.Comm={};WP.Comm.RESPONSETYPE_COMPLETE=2;WP.Comm.RESPONSETYPE_CONTENTONLY=1;WP.Comm.logOut=function(c,d,f,h){var a="function";d=d===true;h=h===true;f=f||"bye.asp";typeof c!==a&&!d&&WP.Comm.clearLoggedInStorage();var g,i=makeLink("Home/LogOut?doRedirect="+(d?"true":"false")+"&logoutPage="+(f||"")),b,e;h&&typeof WP.Events.cancelBeforeUnload===a&&WP.Events.cancelBeforeUnload();typeof closeAllWindows===a&&closeAllWindows();if(d)e=function WP$Comm$logout$executeLogout(){WP.Comm.delayKeepAliveForLogout();window.location=i;typeof c===a&&c();WP.Comm.postLogoutOperations()};else{WP.Comm.logOut.count=0;g=typeof c!==a?WP.Comm.postLogoutOperations:function WP$Comm$logOut$internalAfterExecute(a){var e=a.indexOf('http-equiv="refresh"'),d;if(e>-1){d=a.indexOf("url=",e)+4;b=a.substring(d,a.indexOf('"',d));if(b.substr(0,1)===".")b=b.substr(2);b=HTMLUnencode(b)}if(++WP.Comm.logOut.count===2){delete WP.Comm.logOut.count;c(b||"")}WP.Comm.postLogoutOperations()};e=function WP$Comm$logout$executeLogout(){WP.Comm.delayKeepAliveForLogout();$.ajax({url:i,method:"GET",success:g});$.ajax({url:makeLink(f),method:"GET",success:g})}}if($$WP.IsPendingAJAXRequests){$$WP.PendingAJAXCallBack=e;window.setTimeout(function WP$Comm$logout$failSafeLogout(){if($$WP.PendingAJAXCallBack!==null&&typeof $$WP.PendingAJAXCallBack===a){$$WP.PendingAJAXCallBack();$$WP.PendingAJAXCallBack=null}},6e3)}else e();return false};WP.Comm.logOut.numExecutions=0;WP.CH5=String.fromCharCode(5);WP.Comm.clearLoggedInStorage=function(){var c="OSScheduledCSNs",b="OSApptCountDte",a="OSApptCount",f=localStorage.getItem(a),d=localStorage.getItem(b),e=localStorage.getItem(c);WP.Comm.clearStorage();localStorage.setItem(a,f);localStorage.setItem(b,d);localStorage.setItem(c,e)};WP.Comm.clearStorage=function(){sessionStorage.clear()};WP.Comm.postLogoutOperations=function(){var a=sessionStorage.IEHyperspaceLaunch==="true";WP.Comm.clearLoggedInStorage();a&&window.open("","_self").close()};WP.Comm.startKeepAlive=function(){window.setTimeout(WP.Comm.keepAlive,3e4)};WP.Comm.delayKeepAliveForLogout=function(){WP.Comm.keepAlive.delayForLogout=2};WP.Comm.keepAlive=function(){var b=0,a=function(a){if(a==="0")logOut();else++b===2&&WP.Comm.startKeepAlive()};if(window.location.href.indexOf("publicforms.asp")!==-1)return;if(WP.Comm.keepAlive.delayForLogout>0){--WP.Comm.keepAlive.delayForLogout;WP.Comm.startKeepAlive();return}++WP.Comm.keepAlive.counter;typeof intKeepalive==="function"&&intKeepalive();$.ajax({url:makeLink("keepalive.asp?cnt="+WP.Comm.keepAlive.counter),success:a,method:"GET",global:false});window.location.href.indexOf("termpage.asp")===-1&&window.location.href.indexOf("oeinside.asp")===-1&&$.ajax({url:makeLink("Home/KeepAlive?cnt="+WP.Comm.keepAlive.counter),success:a,method:"GET",global:false})};WP.Comm.keepAlive.counter=0;WP.Comm.keepAlive.delayForLogout=0