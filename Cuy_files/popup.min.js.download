$$WPUtil.guaranteeExistence($$WP,"Popups");$$WPUtil.guaranteeExistence($$WP,"Utilities.UI");var $$WPPop=$$WP.Popups;$$WPContain.Popup=function WPContain$Popup(b){var a=this;$$WPComp.applySettings(b,a);switch(a.Size){case $$WPContain.Popup.SizeEnum.SMALL:a.Class+=" small";break;case $$WPContain.Popup.SizeEnum.MEDIUM:a.Class+=" medium";break;case $$WPContain.Popup.SizeEnum.LARGE:a.Class+=" large"}if(a.positioningFunction===null)a.positioningFunction=$$WPContain.Positions.InsideCentered;a.$parent=a.$parent&&a.$parent.length>0?a.$parent:$afe.jq(document.body);if(a._shouldOverrideMobileBack())if($.isArray(a.Components))a.Components.forEach(function(a){a.IsClosable=false});else a.Components.IsClosable=false;a.Containers$ContainerComponent({});a.addEventListener("resize",a._resizePopup);a.addEventListener("click",a._clickPopup);a.addEventListener("keydown",a._keydownPopup);$$WP.Utilities.UI.IsMobile&&a.addEventListener("focusout",a._onMobileFocusOut);if(a.HasBackButton!==false)if(a.HasBackButton||isDataTile()&&a.IsClosable&&a.Size!=$$WPContain.Popup.SizeEnum.SMALL){if(a.BackButtonText==="")a.BackButtonText=$$WP.Strings.get("PopupBackToPreviousPageButton",a.StringsNamespace);if(a.ToolbarButtons===null)a.ToolbarButtons=[];a.ToolbarButtons.push(new $$WPComp.ComplexObjects.Button(a.BackButtonText,null,"secondary neutral previouspage","close",a.BackButtonText))}};$$WPContain.Popup.SizeEnum={SMALL:1,MEDIUM:2,LARGE:3,AUTO:4};$$WPContain.Popup.__zIndex=0;$$WPContain.Popup.prototype={ToolbarButtons:null,HasOverlay:true,IsClosable:true,Class:"Popup",positioningFunction:$$WPContain.Positions.InsideCentered,Size:$$WPContain.Popup.SizeEnum.SMALL,_IsWindowScrollDisabled:false,_ScrollBarPosition:0,_IsScrollBarDisabledWhenOpened:false,_InitialBodyMarginTop:0,DontMatchColumnHeights:false,$parent:$afe.select("body"),HasBackButton:null,BackButtonText:"",GetLastFocus:null,MonitorAriaLiveContent:true,OnCloseCallback:null,show:function WPContain$Popup$show(e){var d="mobile_back",c="_cachedWindowEvents",b=true,a=this;if(a._visible===b)return;a.__setAriaHiddenForPage(b);if(a.$container.find(".alertLive").length>0)a.MonitorAriaLiveContent=false;if(a.MonitorAriaLiveContent===b){a.$container.safeAttr("aria-live","polite");a.$container.safeAttr("aria-relevant","additions")}a._ScrollBarPosition=$$WPUtil.getScrollTop();a._IsScrollBarDisabledWhenOpened=$afe.select("body").hasClass("scrollDisabled");if(a._IsScrollBarDisabledWhenOpened)a._InitialBodyMarginTop=$afe.select("body").css("margin-top");a.setAppropriateScrollBar();$$WP.Debug.UpdateTopMarginForBanners();if(a.HasOverlay)a._overlay.on(!a.IsClosable,a);a.Containers$ContainerComponent$show(e);popupAlert=a._createPopupAlert();a.$container.safePrepend(popupAlert);a.focus();popupAlert.setAttribute("tabindex","-1");a.setFocus();$afe.jq(window).on("resize orientationchange","",a.ComponentNumber,a.__windowResize);if(a._shouldOverrideMobileBack()){var f=a._getMobileBackEvents();a.$container.data(c,[]);f.forEach(function(a){this.$container.data(c).push(a)},a);$afe.jq(window).off(d);$afe.jq(window).on(d,"",a.ComponentNumber,a.__mobileBack)}a.setAppropriateContentHeight();if(isDataTile()&&a.Size!==$$WPContain.Popup.SizeEnum.SMALL)try{window.history.pushState(null,null,location.href);scrollTopOfTheIframe(0,b)}catch(g){$$WP.Debug.log("Cannot add Push state as the parent domain is not accessible")}},setAppropriateScrollBar:function WPContain$Popup$setAppropriateScrollBar(){var e="scrollDisabled",a=this,c=$afe.select("body"),b=$afe.jq(window),i=$afe.select("#header"),g,f,j,d;g=b.width();f=b.height();j=$$WPUtil.cssValueToPixels(c.css("min-width"));d=a.$container.outerHeight()<=f&&a.$container.outerWidth()<=g;if(!isDataTile()&&d){a._IsWindowScrollDisabled=true;var h=$$WPUtil.getScrollTop();if(h>75)if(!i.hasClass("compact")){i.addClass("compact");b.trigger("compactHeader")}!a._IsScrollBarDisabledWhenOpened&&c.css({"margin-top":"-"+h+"px"}).addClass(e)}else{a._IsWindowScrollDisabled=false;c.css({"margin-top":""}).removeClass(e)}},setAppropriateContentHeight:function WPContain$Popup$setAppropriateContentHeight(){var h="matchColumnHeights",g="#content, #main, #sidebar",f="> .content",a=this,b,m=$afe.select("#header").outerHeight(),i,l,e,j,k,d,c;if(a._IsWindowScrollDisabled){i=$afe.jq(window).innerHeight();l=$afe.select(".Popup > .titlebar").outerHeight();b=i-2*m-20;e=a.$content.contentHeight();c=$$WPUtil.cssValueToPixels(a.$content.css("min-height"));if(typeof c!=="undefined"&&c>b)b=c;if(b<150)b=150;a.$container.find(f).css({"max-height":b+"px","overflow-y":"auto"})}else{a.$container.find(f).css({"max-height":"","overflow-y":"visible"});if(!a.DontMatchColumnHeights&&$$WP.Utilities.UI.MatchColumnHeightsOnHideAndShow){$afe.select(g).css("height","");$afe.jq(window).trigger(h);e=$afe.select("#content").height();j=a.$container.height();k=a.$container.offset().top;d=j+k+150;if(d>e){$afe.select(g).css("height",d+"px");$afe.jq(window).trigger(h)}}}},setFocus:function(){var a=this;try{a.firstFocus=WP.DOM.Search.getNextFocusable(a.$container.get(0))}catch(b){}try{if(a.GetLastFocus!==null)a.lastFocus=a.GetLastFocus(a.$container.get(0));else a.lastFocus=WP.DOM.Search.getLastFocusable(a.$container.get(0))}catch(c){}a.isFirstFocus=false},__windowResize:function(b){if(isDataTile())return;var a=$$WPComp.getInstance(b.data);if(a){a._IsWindowScrollDisabled=false;a.setAppropriateScrollBar();a.$container.trigger("resize")}},hide:function WPContain$Popup$hide(e){var c="mobile_back",b=false,a=this;if(a._visible===b)return;a.__setAriaHiddenForPage(b);a.Containers$ContainerComponent$hide(e);a._visible=b;if(!a._IsScrollBarDisabledWhenOpened)$afe.select("body").css({"margin-top":""}).removeClass("scrollDisabled");else $afe.select("body").css("margin-top",a._InitialBodyMarginTop);$afe.select("#content, #main, #sidebar").css("height","").removeClass("suppressed");$$WP.Utilities.UI.MatchColumnHeightsOnHideAndShow&&!a.DontMatchColumnHeights&&$afe.jq(window).trigger("matchColumnHeights");a._IsWindowScrollDisabled=b;a.HasOverlay&&a._overlay.off(!a.IsClosable,a);try{a.FocusOnClose.focus()}catch(f){}a._ScrollBarPosition&&$$WPUtil.setScrollTop(a._ScrollBarPosition);$afe.select(".Popup.component").length===1&&$afe.jq(window).off("resize orientationchange","",a.__windowResize);if(a._shouldOverrideMobileBack()){var d=a.$container.data("_cachedWindowEvents");if(d){$afe.jq(window).off(c);d.forEach(function(a){$afe.jq(window).on(c,a.selector,a.data,a.handler)})}}typeof a.OnCloseCallback==="function"&&a.OnCloseCallback()},reposition:function WPContain$Popup$reposition(c){var b="opacity",a=this;if(a.$container.parent().length===0)return;var d=a.$container.css(b);a.$container.css(b,0);try{a.positioningFunction({data:a},c)}catch(e){throw"repositioning error";}a.$container.css(b,d)},setTitle:function(f,a,g,d){var c="clearlabel",b=this,e;if(!f&&(!a||a.length===0)&&!d){e=true;a=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("JumpToContent","Core.Popup"),null,c,"jumptocontent")];b.$container.addClass("notitle")}else b.$container.removeClass("notitle");b.Containers$ContainerComponent$setTitle(f,a,g,d);e&&b.$title.addClass(c)},_resizePopup:function WPContain$Popup$_resize(){var a=this;if(!a.isVisible())return false;a.reposition(false);a.setAppropriateContentHeight();a.setFocus();return false},_clickPopup:function(a){if(a.dataId===$$WPComp.TITLEBARIDENTIFIER+"jumptocontent"){this.focus(true);return false}else if(a.dataId==="focusanchor")return false},_onMobileFocusOut:function(a){!a.relatedTarget&&$afe.jq(window).scrollTop(0)},_keydownPopup:function WPContain$Popup$_keydown(b){var c=false,a=this,e=$afe.select(".infoBubbleWrapper.hover").size()>0;b.keyCode===27&&a.IsClosable&&!e&&a.dispose(c);if(b.keyCode!==9)return;if(b.target!==a.firstFocus&&b.target!==a.lastFocus){if(a.isFirstFocus){var d=b.shiftKey?a.lastFocus:a.firstFocus;d&&d.focus();delete a.isFirstFocus;return c}return}if(b.shiftKey&&b.target===a.firstFocus){a.lastFocus&&a.lastFocus.focus();if(a.isFirstFocus)delete a.isFirstFocus;return c}if(!b.shiftKey&&b.target===a.lastFocus){a.firstFocus&&a.firstFocus.focus();if(a.isFirstFocus)delete a.isFirstFocus;return c}},__mobileBack:function(b){var a=$$WPComp.getInstance(b.data);a&&a.dispose()},_shouldOverrideMobileBack:function WPContain$Popup$_shouldOverrideMobileBack(){if(!$$WP.Utilities.UI.IsMobile||this.Size!==$$WPContain.Popup.SizeEnum.MEDIUM&&this.Size!==$$WPContain.Popup.SizeEnum.LARGE||isDataTile())return false;var a=this._getMobileBackEvents();return a&&a.length>0},_getMobileBackEvents:function WPContain$Popup$_getMobileBackEvents(){var a=$._data(window,"events");return a?a.mobile_back:null},_overlay:{on:function WPContain$Popup$overlay$on(d,a){var c,b;b=$afe.select("body");if(!b.length)b=$afe.select("#datatile");$$WPContain.Popup.__zIndex+=3;c=3e3+$$WPContain.Popup.__zIndex;a.$overlay=$afe.renderTemplate($$WP.Templates.Core.overlay,{});b.safeAppend(a.$overlay);a.$overlay.show();a.$overlay.css("z-index",c);a.$container.css("z-index",c+1);$$WP.Utilities.UI.PDF&&$$WP.Utilities.UI.PDF.needIframeShim()&&$$WP.Utilities.UI.PDF.pageHasEmbeddedPdf()&&$$WP.Utilities.UI.PDF.hidePdfs();if(!d)a.$overlay.on("click","",a.ComponentNumber,a._overlay._overlayClick)},off:function WPContain$Popup$overlay$off(c,a){var b;!c&&a.$overlay.off("click","",a._overlay._overlayClick);a.$overlay.remove();b=$afe.select(".lb_overlay:visible").length;$$WP.Utilities.UI.PDF&&$$WP.Utilities.UI.PDF.needIframeShim()&&$$WP.Utilities.UI.PDF.pageHasEmbeddedPdf()&&b==0&&$$WP.Utilities.UI.PDF.showPdfs()},_overlayClick:function WPContain$Popup$overlay$overlayClick(b){var a=$$WPComp.getInstance(b.data);a&&a.dispose();return $$WPUtil.preventEvent(b)}},__setAriaHiddenForPage:function(b){var a=this.__getPageIdsForAria();for(i=0;i<a.length;i++)a[i].setAttribute("aria-hidden",b)},__getPageIdsForAria:function(){var b=this,a=[];b.__addIdToArray("header",a);b.__addIdToArray("footer",a);b.__addIdToArray("content",a);b.__addIdToArray("menu-container",a);b.__addIdToArray("toastWrapper",a);return a},__addIdToArray:function(c,b){var a=document.getElementById(c);a&&b.push(a)},_createPopupAlert:function(){var c="@MYCHART@PopupTitle@",a=document.createElement("span");a.className="clearlabel";a.setAttribute("tabindex","0");a.setAttribute("role","alert");this.hasOwnProperty("PierceShieldOfJustice")&&a.setAttribute("data-pierce-shield","true");var d=this._Title.Text.toString(),b=$$WP.Strings.getNamespace("Core.Popup"),e=isDataTile()&&this.Size!==$$WPContain.Popup.SizeEnum.SMALL?"PopupWindowAlert":"PopupAlert";e+=d?"WithTitle":"";b.addMnemonic(c,d);var f=b.getStringForTemplate(e);b.removeMnemonic(c);a.appendChild(document.createTextNode(f));return a}};$$WPContain.Popup.extend("Containers.ContainerComponent")