/*! Copyright (c) Epic Systems Corporation 2012 - 2018 */
var WP=WP||{};if(typeof WP.FdiUtils==="undefined")WP.FdiUtils={};WP.FdiUtils.handleFDILink=function WP$FdiUtils$handleFDILink(j){var f,d,c,a,h,g,i,b,e,k;b="";f=$afe.jq(j.target);j.preventDefault();d=f.closest("[data-fdi-context]");if(d.length>0){c=d.safeAttr("data-fdi-context");if(c!==""){a=$.parseJSON(c);h=a.fdi;g=a.csn;i=a.ord;e=a.DocumentID;k=a.eptId;delete a.fdi;delete a.csn;delete a.ord;delete a.DocumentID;delete a.eptId;b=WP.FdiUtils.buildFDILinkParamString(h,g,i,a,e,k)}}getCSRFTokenAsQS(function(a){$.ajax({url:makeLink("Extensibility/Redirection/FdiData"+b),type:"POST",dataType:"json",data:a,success:function(a){WP.FdiUtils.fdiJSONSuccess(a,b)}})})};WP.FdiUtils.fdiJSONSuccess=function WP$FdiUtils$fdiJSONSuccess(d,f){var a,b,c,e;a=d.url;b=d.launchmode;e=d.IsFdiPost;if(b===4)a=makeLink(a);if(e)a=makeLink("Extensibility/Redirection/FdiRedirection"+f);switch(b){case 1:case 4:window.location.href=a;break;case 0:case 2:case 3:default:c=openWindow(a,"","",null,true,false,true);(c==null||c===undefined)&&!WP.DOM.Browser.isIE&&!WP.DOM.Browser.isEdge&&WP.FdiUtils.PopupBlocked(a)}};WP.FdiUtils.PopupBlocked=function WP$FdiUtils$PopupBlocked(b){var a;$$WP.Strings.setDefaultNamespace("Global");a=new $$WPComp.MessageComponent({TitleText:$$WP.Strings.get("BlockedPopupTitle"),Message:$$WP.Strings.get("BlockedPopupMessageWithLink"),ToolbarButtons:[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("BlockedPopupLaunchBtnTitle"),null,"completeworkflow","LaunchLink"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("BlockedPopupCancelBtnTitle"),null,"cancelworkflow","")],IsCloseable:true});a.addEventListener("click",$.proxy(this.LaunchClickHandler,this,b));$$WPUtil.quickPopup(a)};WP.FdiUtils.LaunchClickHandler=function WP$FdiTuils$LaunchClickHandler(b,a){a&&a.dataId&&a.dataId==="toolbarLaunchLink"&&openWindow(b,"","",null,true,false,true)};WP.FdiUtils.buildFDILinkParamString=function WP$FdiUtils$buildFDILinkParamString(f,e,g,d,b,c){var a;a="";if(f)a=$$WPUtil.addUrlParameter(a,"fdi",encodeURIComponent(f));else return"";if(e)a=$$WPUtil.addUrlParameter(a,"csn",encodeURIComponent(e));if(g)a=$$WPUtil.addUrlParameter(a,"ord",encodeURIComponent(g));if(!$.isEmptyObject(d))a=$$WPUtil.addUrlParameter(a,"extra",encodeURIComponent(JSON.stringify(d)));if(b)a=$$WPUtil.addUrlParameter(a,"DocumentID",encodeURIComponent(b));if(c)a=$$WPUtil.addUrlParameter(a,"eptID",encodeURIComponent(c));return a}